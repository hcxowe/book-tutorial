# HTTP: Web基础

## HTTP报文

> 如果说HTTP是因特网的信使，则HTTP报文则是用来搬东西的包裹

### 报文是如何流动的

无论响应报文还是请求报文，都是从发送方流向接收方

### HTTP报文的三个组成部分 - 起始行 首部 主体

起始行 - 对报文进行描述, 请求报文的起始行说明要做些什么，响应报文的起始行说明发生了什么

首部 - 包含属性

主体 - 包含数据

### 请求与响应报文之间的区别

请求报文格式   
`<method> <requiest URL> <version>`   
`<headers>`   
`<entity-body>`

响应报文格式   
`<version> <status> <reason msg>`   
`<headers>`   
`<entity-body>`

### 请求报文支持的各种功能（方法）

GET | 从服务器获取资源 |  无主体   
POST | 发送需要处理的数据 | 有主体   
HEAD | 只从服务器获取资源的首部 | 无主体   
PUT | 将请求主体的部分在服务器上创建URL请求命名的新文档 | 有主体   
TRACE | 可以使客户端在最终将请求发送给服务器时，看看请求变成了什么样子，目标服务器会在响应主体中携带它收到的请求报文 | 无主体   
OPTIONS | 决定可以在服务器上执行哪些方法 | 无主体   
DELETE | 从服务器上删除一份资源 | 无主体

### 响应报文的各种状态

整体范围 | 已定义范围 | 分类   
100 - 199 | 100 ~ 101 | 信息提示   
200 - 299 | 200 ~ 206 | 成功   
300 - 399 | 300 ~ 305 | 重定向   
400 - 499 | 400 ~ 415 | 客户端错误   
500 - 599 | 500 ~ 505 | 服务器错误   

常见的状态码：
- 100 --- 收到初始部分，请客户端继续
- 101 --- 服务器正在根据客户端指定，将协议切换成Update首部所列出的协议
- 200 --- 没问题
- 201 --- 用于创建服务器对象的请求，如PUT，表明对象已经创建
- 202 --- 请求已接收，但还未对其进行任何动作，服务器不能保证完成这个请求
- 203 --- 实体首部包含的信息不是来自于源服务器，而是来自于资源的一个副本
- 204 --- 响应中无实体的主体部分
- 205 --- 主要用于浏览器的代码，负责告知浏览器清楚当前页面中的所有html表单元素
- 206 --- 成功执行了一个部分或Range（范围）请求
- 300 --- 客户端请求一个实际指向多个资源的URL时返回这个状态
- 301 --- 请求的URL被移除，响应的Location中包含资源现在处于的URL
- 302 --- 请求的URL临时移动，临时使用Location中的URL，将来的请求仍使用老的URL
- 303 --- 告知客户端使用另一个URL获取资源，主要目的是允许POST请求的响应将客户端定向到某个资源上去
- 304 --- 资源未修改
- 305 --- 用来说明必须通过一个代理来访问资源
- 307 --- 与302一样，用于在HTTP/1.1服务器将302状态保留起来供HTPP/1.0客户端使用
- 400 --- 客户端发送了一个错误的请求
- 401 --- 请求认证
- 402 --- 保留未使用该状态码
- 403 --- 请求被服务器拒绝
- 404 --- 无法找到请求的资源
- 405 --- 请求的方法服务器不支持
- 406 --- 服务器没有客户端可接受的相匹配的资源
- 407 --- 同401，用于要求认证对资源请求的代理服务器
- 408 --- 请求超时
- 409 --- 用于说明请求可能在资源上引发的一些冲突
- 410 --- 同404，只是服务器曾经拥有过此资源
- 411 --- 服务器要求在请求报文中包含Content-Length
- 412 --- 客户端发送了条件请求，在其中一个请求失败时使用
- 413 --- 客户端发送的实体主体部分比服务器要求处理的要大时使用
- 414 --- 客户端请求URL比服务器要求的要长时使用
- 415 --- 服务器无法理解客户端发送的实体的内容类型
- 416 --- 请求报文请求的是指定资源的某个范围，而此范围无效或无法满足
- 417 --- 请求的Expect请求首部包含一个期望，但服务器无法满足
- 500 --- 服务器发生错误
- 501 --- 客户端发送的请求超出服务器的能力范围，比如使用服务器不支持的请求方法
- 502 --- 作为代理或网关从请求响应链的下一条链路上受到了一条伪响应
- 503 --- 服务器暂时无法响应请求
- 504 --- 同408，只是这里的响应来自一个网关或代理，他们在等待另一服务器响应是超时
- 505 --- 服务器收到的请求使用了它们无法或不愿支持的协议版本

### 各种各样的HTTP首部都是用来做什么的

#### 通用首部 - 可以出现在请求&响应报文中

- Connection --- 指定与请求/响应连接有关的选项
- Date --- 说明构建报文时的时间与日期
- MIME-Version --- 使用MIME版本
- Trailer --- 如果报文采用了分块传输编码方式，用这个首部列出位于报文拖挂部分的首部集合
- Transfer-Encoding --- 告知接收端为了保证报文的可靠传输对报文采用了什么编码
- Update --- 发送端可能想要升级使用的新版本或协议
- Via --- 显示报文经过的中间节点，如网关、代理
- Cache-Control --- 用于随报文传送缓存指示
- Pragma --- 另一种随报文传送指示的方式

#### 请求首部 - 只能出现在请求报文中

- Client-IP --- 客户端IP
- From --- 客户端用户的Email地址
- Host --- 请求服务器的主机名和端口号
- Referer --- 请求URI的文档的URL
- UA-Color --- 客户端显示器显示颜色相关信息
- UA-CPU
- UA-Disp --- 客户端显示器能力有关的信息
- UA-OS --- 客户端机器的操作系统和版本
- UA-Pixels --- 客户端显示器的像素信息
- User-Agent --- 发起请求的应用程序名称
- Accept --- 客户端接受的媒体类型
- Accept-Charset --- 字符集
- Accept-Encoding --- 编码方式
- Accept-Language --- 语言
- TE --- 告诉服务器可以使用的扩展传输编码
- Expect --- 客户端列出请求所要求的服务器行为
- If-Match --- 如果实体标记与文档当前的实体标记匹配就获取这个文档
- If-Modified-Since --- 如果在某个指定的日期后资源修改过
- If-Unmodified-Since --- 如果在某个指定的日期后资源没有修改
- If-None-Match --- 如果提供的实体标记与文档当前实体标记不匹配，就获取这个文档
- If-Range --- 允许对文档的某个范围进行条件请求
- Range --- 如果服务器支持范围请求，就请求资源的指定范围
- Authorization --- 客户端提供给服务器，以便对其自身进行认证的数据
- Cookie
- Cookie2 --- 用来说明请求端支持的Cookie版本
- Max-Forward --- 将请求转发给其他代理或者网关的最大次数-与TRACE方法一起使用
- Proxy-Authorization --- 代理的认证数据
- Proxy-Connection --- 与代理建立连接时相关信息

#### 响应首部 - 只能出现在响应报文中

- Server --- 服务器信息
- Age --- 响应持续时间
- Public --- 服务器为其资源支持的请求方法列表
- Retry-After --- 如果资源不可用，在此日期或时间重试
- Title --- HTML文档标题
- Warning --- 警告报文
- Accept-Ranges --- 对此资源来说，服务器可接受的类型
- Vary --- 一个首部列表，服务器会根据这些首部内容选择最适合的资源版本发送
- Proxy-Authorization --- 代理对客户端的质询列表
- Set-Cookie
- Set-Cookie2
- WWW-Authorization --- 来自服务器对客户端的质询列表

#### 实体首部 - 描述主体的长度和内容，或资源本身

- Allow --- 列出了可以对此实体执行的请求方法
- Location --- 告知客户端实体实际上位于何处
- Content-Type --- 说明实体主体部分的数据类型
- Content-Base --- 解析主体的相对URL时使用的基础URL
- Content-Encoding
- Content-Language
- Content-Length
- Content-Location --- 资源实际所处的位置
- Content-MD5 --- 主体的MD5校验和
- Content-Range --- 在整个资源中实体表示的字节范围
- ETag --- 实体标记
- Expires --- 实体不再有效，要从原始的源端再次获取此实体的日期和时间
- Last-Modified --- 实体最后修改的日期和时间

#### 扩展首部 - 规范之外的首部