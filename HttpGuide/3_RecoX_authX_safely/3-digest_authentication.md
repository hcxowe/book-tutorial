# 识别、认证、安全

## 摘要认证

摘要认证是另一种HTTP认证协议，它试图修复基本认证协议的严重缺陷，摘要认证进行了如下改进
- 永远不会以明文方式在网络上发送密码
- 可以防止恶意用户捕获并重放认证的握手过程
- 可以有选择地防止对报文内容的篡改
- 防范其他几种常见的攻击方式

### 单向摘要

摘要是一种单向函数，用于将无限的输入值转换为有限的浓缩输出值，常见的摘要函数 MD5

用摘要函数对密码进行加密，然后发起服务器认证，虽然密码不可解，但是无法阻止重放攻击， 如 穷举法， 词典攻击

### 随机数防止重放攻击

服务器每次认证都生成一个随机数给客户端，客户端将随机数附加到密码后面在计算出摘要，这样每次的密码摘要随着随机数变化

随机数通过`WWW-Authenticate`首部发送给客户端

### 摘要认证的预授权

由于摘要认证使用随机数技术来破坏重放攻击，每条请求都需要进行 `请求->质询->请求+授权->成功`

预授权在第一次`请求->质询->请求+授权->成功`在成功的响应信息中附加一个随机数信息，客户端在下一次请求的时候不需要在进行质询过程获取随机数，直接根据上一次请求的随机数进行下一次的授权请求，过程如下：   
第一次请求时`请求->质询->请求+授权->成功+随机数信息`   
下一条请求时 `请求+授权->成功+随机数信息`

### 客户端无需等到新的`WWW-Authenticate`质询就可以获取正确的随机数

- 服务器预先在`Authentication-info`成功首部中发送下一条随机数
- 服务器允许在一小段时间内使用同一个随机数
- 客户端和服务器使用同步的、可预测的随机数生成算法

### 安全性问题

- 首部篡改
- 重放攻击
    > 在当期上下文中，重放攻击指的是有人将从某个事务中窃取的认证证书用于另一个事务
- 多重认证机制
    > 提供给用户可选择的基本认证与摘要认证
- 词典攻击
    > 密码猜想型攻击方式
- 恶意代理攻击和中间人攻击
- 选择明文攻击
- 存储密码
    > 如果服务器被入侵，攻击者拿到存储密码的文件


**尽管摘要认证提供的解决方案比基本认证强壮却安全，但它并没有为内容的安全提供任何保证**

**真正安全的事务只有通过SSL才能实现**